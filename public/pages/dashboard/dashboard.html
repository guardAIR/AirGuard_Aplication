<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | AirGuard</title>
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

</head>

<body onload="dados(); getAlertaById(sessionStorage.getItem('ID_EMPRESA'))">
    <nav class="horizontal_nav">
        <a href="/index.html" class="logo">
            <img src="/assets/dashboard/logo.svg">
        </a>
        <div class="links">
            <ul>
                <li><a href="/pages/sobre-nos/sobre_nos.html">Sobre nós</a></li>
                <li><a href="/pages/calculadora/calculadora.html">Orçamento</a></li>
                <li><a href="./dashboard_area.html" class="destaque_link">dashboard area</a></li>
            </ul>
        </div>
    </nav>
    <nav class="vertical_nav">
        <ul>
            <li><a href="dashboard.html" class="active"><span class="material-symbols-outlined">domain</span></a></li>
            <li><a href="dashboard_area.html"><span class="material-symbols-outlined">location_on</span></a></li>
            <li><a href="add_member.html"><span class="material-symbols-outlined">person_add</span></a></li>
            <li><a href="perfil.html"><span class="material-symbols-outlined">account_circle</span></a></li>
        </ul>
    </nav>

    <section>
        <div class="dashboard_header">
            <h1>Medição geral</h1>
            <p>Bem-vindo de volta, <strong id="NomeUsuario">Air Guard ADM</strong></p>
        </div>
        <div class="dashboard_cards">
            <div class="left">
                <div class="row row2">
                    <div class="card card3">
                        <h3>5 Áreas com a maior concentração de CO</h3>
                        <div class="ranking" id="rankingContainer"></div>
                        <div class="ranking_legend">
                            <p><strong>Legenda:</strong></p>
                            <ul>
                                <li><span class="legend_color blackred_bar"></span> Acima de 39 ppm – Perigoso (vermelho escuro)</li>
                                <li><span class="legend_color red_bar"></span> Até 39 ppm – Alerta (vermelho)</li>
                                <li><span class="legend_color yellow_bar"></span> Até 30 ppm – Atenção (amarelo)</li>
                                <li><span class="legend_color green_bar"></span> Até 20 ppm – Nível seguro (verde)</li>
                            </ul>
                            <p><em>Observação:</em> 100% representa 39 ppm. Valores acima disso estão além do limite
                                seguro recomendado.</p>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="card card1">
                        <h3>Resumo de áreas</h3>
                        <div class="kpi_card1">
                            <span>Atenção:</span><br>
                            <span class="kpi_destaque">1 Área acima</span>
                        </div>
                        <canvas id="COperArea"></canvas>
                    </div>
                </div>
            </div>
            <div class="right">
                <div class="card card4">
                    <h3>Alertas</h3>
                    <div class="alerts" id="alert"> 
                        <div class="alert alert1">
                            <img src="/assets/dashboard/img_area.png">
                            <h4>Linha de produção 1</h4>
                            <p>42ppm</p>
                            <p class="comparison trending_up">
                                <span class="material-symbols-outlined alert_icon">
                                    trending_up
                                </span>
                                7.69%
                            </p>
                        </div>
                        <div class="alert alert2">
                            <img src="/assets/dashboard/img_area.png">
                            <h4>Linha de produção 2</h4>
                            <p>30ppm</p>
                            <p class="comparison trending_down">
                                <span class="material-symbols-outlined alert_icon">
                                    trending_down
                                </span>
                                23.08%
                            </p>
                        </div>
                        <div class="alert alert3">
                            <img src="/assets/dashboard/img_area.png">
                            <h4>Linha de produção 3</h4>
                            <p>23ppm</p>
                            <p class="comparison trending_down">
                                <span class="material-symbols-outlined alert_icon">
                                    trending_down
                                </span>
                                41.03%
                            </p>
                        </div>
                        <div class="alert alert4">
                            <img src="/assets/dashboard/img_area.png">
                            <h4>Linha de produção 4</h4>
                            <p>16ppm</p>
                            <p class="comparison trending_down">
                                <span class="material-symbols-outlined alert_icon">
                                    trending_down
                                </span>
                                58.97%
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>

</html>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script
    src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.4.0/dist/chartjs-plugin-annotation.min.js"></script>
<script src="../../js/geralDashboards.js"></script>

<script>
    function dados() {
        var nome = sessionStorage.NOME_USUARIO;
        var sobrenome = sessionStorage.SOBRENOME_USUARIO;

        NomeUsuario.innerHTML = `${nome} ${sobrenome}`;
    }

    function getAlertaById(id) {
        console.log('bruno');
    fetch('/areas/getAlertaById/' + id, { method: 'GET' })
        .then(function (resultado) {
            resultado.json()
                .then(function (json) {
                    var alerta = document.getElementById("alert");

                    for (let i = 0; i < json.length; i++) {
                        alerta.innerHTML += `                        
                        <div class="alert alert1">
                            <img src="/assets/dashboard/img_area.png">
                            <h4>${json[i].nome}</h4>
                            <p>${json[i].concentracao}ppm</p>
                            <p class="comparison trending_up">
                                <span class="material-symbols-outlined alert_icon">
                                    trending_up
                                </span>
                                7.69%
                            </p>
                        </div>`
                    }
                })
        })
}
</script>